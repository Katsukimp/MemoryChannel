using MemoryEventBus.Domain.Events.Aggregate;
using MemoryEventBus.Domain.Events.Concrete;
using MemoryEventBus.Domain.Events.Interfaces.Base;
using MemoryEventBus.Domain.Events.Interfaces.Producers;
using System.Threading.Channels;

namespace MemoryEventBus.Infrastructure.Events.Producers
{
    public class OrderPaidProducer : IOrderPaidProducer
    {
        private readonly Channel<DomainEvent> _channel;

        public OrderPaidProducer(IEventChannelManager channelManager)
        {
            _channel = channelManager.GetOrCreateChannel<OrderPaidEvent>();
        }
        public async Task PublishAsync(OrderPaidEvent @event) 
        {
            await _channel.Writer.WriteAsync(@event);
            Console.WriteLine("Sent message for OrderPaidTopic.");
        } 
    }
}
